Задания выполняются на платформе [SQL Fiddle](http://www.sqlfiddle.com/) 

1. [Пример работы на платформе](http://www.sqlfiddle.com/#!9/a6c585/1)
2. [SQL Style Guide](https://www.sqlstyle.guide/)



# 【Задание 4】
#### Задание 4.1 Такси и клиенты

#### В таблице `Trips` хранится информация о поездках в такси. Каждая поездка имеет уникальный идентификатор `Id`. `Client_Id` и `Driver_Id` являются внешними ключами для `Users_Id` в таблице `Users`. `Status` — это тип перечисления, а членами перечисления являются (`completed`, `cancelled_by_driver`, `cancelled_by_client`).



| Id | Client_Id | Driver_Id | City_Id | Status |Request_at|
|----|-----------|-----------|--------|-------------------|--------|
| 1 | 1 | 10 | 1 | completed |2021-10-01|
| 2 | 2 | 11 | 1 | cancelled_by_driver|2021-10-01|
| 3 | 3 | 12 | 6 | completed |2021-10-01|
| 4 | 4 | 13 | 6 | cancelled_by_client|2021-10-01|
| 5 | 1 | 10 | 1 | completed |2021-10-02|
| 6 | 2 | 11 | 6 | completed |2021-10-02|
| 7 | 3 | 12 | 6 | completed |2021-10-02|
| 8 | 2 | 12 | 12 | completed |2021-10-03|
| 9 | 3 | 10 | 12 | completed |2021-10-03|
| 10 | 4 | 13 | 12 | cancelled_by_driver|2021-10-03|

В таблице `Users` хранятся все клиенты. У каждого клиента есть свой уникальный ключ `Users_Id`. `Banned` указывает, забанен клиент или нет, а `Role` представляет собой тип перечисления (`client`, `driver`, `partner`).

| Users_Id | Banned | Role |
|----------|--------|--------|
| 1 | No | client |
| 2 | Yes | client |
| 3 | No | client |
| 4 | No | client |
| 10 | No | driver |
| 11 | No | driver |
| 12 | No | driver |
| 13 | No | driver |

Указания.


4.1.1 Создайте таблицу `Users`.


4.1.2 Создайте таблицу `Employee`.



4.1.3 Вставьте данные в таблицу `Users`：

Ответ:


4.1.4 Вставьте данные в таблицу `Trips`：




#### Напишите SQL-запрос, чтобы узнать количество отмен для незаблокированных пользователей (`Cancellation Rate`) с **1 октября 2021 года** по **3 октября 2021 года**. `Cancellation Rate` округляется до двух знаков после запятой.

Требуемый результат выполнения `DML`-  и `DDL`-скриптов в [SQL Fiddle](http://www.sqlfiddle.com/):

| Day | Cancellation Rate |
|------------|-------------------|
| 2021-10-01 | 0.50 |
| 2021-10-02 | 0.00 |
| 2021-10-03 | 0.50 |


#### Задание 4.2  Топ-3 сотрудника с высокой зарплатой в каждом отделе 

Создайте таблицу сотрудников2 `Employee2` вставьте следующие данные:
| Id | Name | Salary | DepartmentId |
|----|-------|--------|--------------|
| 1 | Joe | 70000 | 1 |
| 2 | Henry | 80000 | 2 |
| 3 | Sam | 60000 | 2 |
| 4 | Max | 90000 | 1 |
| 5 | Janet | 69000 | 1 |
| 6 | Randy | 85000 | 1 |

Указания.

4.2.1 Создайте таблицу `Employee2`：

4.2.2 Вставьте данные в таблицу `Employee2`：

4.2.3 Создайте таблицу `Department` с информацией обо всех отделах компании.

| Id | Name |
|----|----------|
| 1 | IT |
| 2 | Sales |

4.2.4 Вставьте данные в таблицу `Department`：

4.2.5 Напишите SQL-запрос, чтобы найти трех самых высокооплачиваемых сотрудников в каждом отделе.

Требуемый результат выполнения `DML`-  и `DDL`-скриптов в [SQL Fiddle](http://www.sqlfiddle.com/):

| Department | Employee | Salary |
|------------|----------|--------|
| IT | Max | 90000 |
| IT | Randy | 85000 |
| IT | Joe | 70000 |
| Sales | Henry | 80000 |
| Sales | Sam | 60000 |
