# Вариант 4: Служба доставки еды

### Легенда
Вы разрабатываете БД для агрегатора доставки еды. Система должна хранить информацию о ресторанах, курьерах и выполняемых ими заказах.

*   **`Restaurants` (Рестораны):** список ресторанов-партнеров.
*   **`Couriers` (Курьеры):** данные о курьерах.
*   **`Deliveries` (Доставки):** информация о заказах, связывающая ресторан, курьера, адрес и статус доставки.

---
### Задание 1: Проектирование и реализация (10 баллов)
1.  **Создайте ER-диаграмму** для таблиц `Restaurants`, `Couriers`, `Deliveries`. Определите атрибуты, типы данных, ПК и ВК.
2.  **Напишите SQL-скрипт (`CREATE TABLE`)** для создания таблиц. Используйте `PRIMARY KEY`, `FOREIGN KEY`, `NOT NULL`, и тип данных `ENUM` для статуса доставки (`'pending'`, `'in_progress'`, `'delivered'`).
3.  **Письменно обоснуйте**, почему ваша схема находится в **третьей нормальной форме (3NF)**.

---
### Задание 2: Работа с данными и сложные запросы (10 баллов)
1.  Наполните таблицы данными (3 ресторана, 5 курьеров, 15 доставок).
2.  **Напишите SQL-запросы:**
    *   **Простой `SELECT`:** Найти всех курьеров на автомобиле.
    *   **`UPDATE`:** Изменить статус заказа с "in\_progress" на "delivered".
    *   **`SELECT` с `INNER JOIN`:** Показать все доставки (адрес, имя курьера, название ресторана), имеющие статус "pending".
    *   **`SELECT` с `LEFT JOIN`:** Вывести список **всех** ресторанов и количество выполненных ими доставок.
    *   **`SELECT` с `GROUP BY` и `HAVING`:** Найти курьеров, выполнивших более 5 доставок.
    *   **Сложный запрос:** Рассчитать общую сумму чаевых (предположим, в `Deliveries` есть поле `tip`) для каждого курьера за сегодня.

---
### Задание 3: Оптимизация и анализ схемы (10 баллов)
1.  **Анализ запроса:** Выполните `EXPLAIN` для запроса поиска ресторана по части названия (`... WHERE name LIKE '%пицца%'`). Объясните его неэффективность.
2.  **Создание индекса:** Создайте индекс для поля `status` в таблице `Deliveries` для ускорения выборки по статусу. Напишите команду `CREATE INDEX`.
3.  **Реверс-инжиниринг:** Сгенерируйте схему вашей БД с помощью DBeaver или аналога.
4.  **Сравнение:** Сравните сгенерированную схему с вашей исходной ER-диаграммой и опишите различия.

***

