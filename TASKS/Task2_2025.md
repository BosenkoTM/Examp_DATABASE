# Вариант 2: Управление IT-активами (IT Asset Management)

### Легенда
Вы разрабатываете базу данных для IT-отдела компании. Система должна отслеживать корпоративное оборудование (ноутбуки, мониторы, телефоны), сотрудников, а также факты выдачи оборудования конкретным сотрудникам.

*   **`Employees` (Сотрудники):** информация о сотрудниках компании (ФИО, должность, отдел).
*   **`Assets` (Активы):** каталог IT-оборудования (тип актива, модель, серийный номер, дата покупки).
*   **`Assignments` (Выдачи/Назначения):** таблица, которая фиксирует, какой актив какому сотруднику был выдан, дату выдачи и плановую дату возврата.

---
### Задание 1: Проектирование и реализация (10 баллов)
1.  **Создайте ER-диаграмму** для таблиц `Employees`, `Assets`, `Assignments`. Определите атрибуты, типы данных, первичные и внешние ключи.
2.  **Напишите SQL-скрипт (`CREATE TABLE`)** для создания таблиц. Включите ограничения `PRIMARY KEY`, `FOREIGN KEY` (например, с `ON DELETE RESTRICT`, чтобы нельзя было удалить сотрудника, за которым числится актив), `NOT NULL` и `DEFAULT` для даты выдачи (`DEFAULT CURRENT_DATE`).
3.  **Письменно обоснуйте**, почему ваша схема находится в **третьей нормальной форме (3NF)**.

---
### Задание 2: Работа с данными и сложные запросы (10 баллов)
1.  Наполните таблицы тестовыми данными (5 сотрудников, 10 активов, 15 записей о выдаче).
2.  **Напишите SQL-запросы:**
    *   **Простой `SELECT`:** Найти все активы типа 'Laptop', купленные в прошлом году.
    *   **`UPDATE`:** Сотрудник вернул актив. Необходимо зафиксировать фактическую дату возврата в таблице `Assignments`.
    *   **`SELECT` с `INNER JOIN`:** Вывести список всего оборудования (модель, серийный номер), которое числится за сотрудником "Сидоровым С.С.".
    *   **`SELECT` с `LEFT JOIN`:** Вывести список **всех** сотрудников и количество активов, закрепленных за каждым из них. Сотрудники без активов также должны быть в списке.
    *   **`SELECT` с `GROUP BY` и `HAVING`:** Найти отделы, за сотрудниками которых числится более 5 единиц оборудования.
    *   **Сложный запрос:** Найти все "просроченные" активы, то есть те, которые не были возвращены в плановую дату (`expected_return_date`), а фактическая дата возврата (`actual_return_date`) пуста.

---
### Задание 3: Оптимизация и анализ схемы (10 баллов)
1.  **Анализ запроса:** Выполните `EXPLAIN` для запроса поиска актива по части его серийного номера (`... WHERE serial_number LIKE '%A78D%'`). Объясните, почему он приводит к полному сканированию таблицы.
2.  **Создание индекса:** Создайте индекс для поля `department` (отдел) в таблице `Employees` для ускорения поиска сотрудников по отделам. Напишите команду `CREATE INDEX`.
3.  **Реверс-инжиниринг:** Сгенерируйте схему вашей БД с помощью DBeaver или аналога.
4.  **Сравнение:** Сравните сгенерированную схему с вашей исходной ER-диаграммой и опишите различия.

***
